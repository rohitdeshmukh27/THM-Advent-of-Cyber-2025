# üéÑ **Task 1 ‚Äî Introduction**

### **Learning Objectives**

Understand:

- Principles of malware analysis
- Static vs dynamic analysis
- What sandboxes are
- Tools: **PeStudio**, **Regshot**, **ProcMon**

### **Key Points**

- Never run malware on your main machine ‚Üí always use **sandboxed VMs**.
- Malware analysis helps uncover behavior, persistence, network communication, and indicators of compromise.

---

# üéÑ **Task 2 ‚Äî Malware Analysis Using Sandboxes**

## **1. Principles of Malware Analysis**

- **Static Analysis:**
  Inspect file _without executing it_. Useful for:

  - Hashes (SHA256)
  - Strings (URLs, IPs, flags, commands)
  - Imports (API calls like CreateFileW)
  - Resources (icons, embedded data)

- **Dynamic Analysis:**
  Run malware to observe behavior such as:

  - Registry changes (persistence)
  - File operations
  - Network activity

---

## **2. Sandboxes**

- Isolated VMs designed for safely running malware.
- Support snapshots to revert system state.
- Mandatory for executing suspicious samples.

---

## **3. Tools Used**

### **PeStudio (Static Analysis)**

Helps identify:

- **SHA256 hash**
- Strings ‚Üí may reveal attacker infrastructure
- Imports ‚Üí how malware interacts with Windows
- Resources ‚Üí embedded objects

---

### **Regshot (Dynamic Analysis)**

- Takes **before & after** registry snapshots.
- Highlights registry modifications ‚Üí usually used to identify **persistence** (Run keys).

---

### **ProcMon (Dynamic Analysis)**

- Captures process-level events:

  - Registry modifications
  - File creation
  - TCP connections

- Heavy noise ‚Üí filtering is essential (Process Name, Operations like TCP Connect).

---

# ‚úÖ **Questions & Answers (Required Format)**

### **Static Analysis: What is the SHA256Sum of HopHelper.exe?**

Using PeStudio, open the tool and drag-and-drop the file. Wait until the analysis finishes, then go to:

`Indicators ‚Üí File ‚Üí sha256`
Copy the long SHA256 hash value displayed there.

<details>
  <summary>Click to reveal the answer</summary>

**The answer:** F29C270068F865EF4A747E2683BFA07667BF64E768B38FBB9A2750A3D879CA33

</details>

---

### **Static Analysis: What is the THM{XXXXX} flag found in the strings?**

In PeStudio, click on the ‚ÄúStrings‚Äù section, then click on the ‚ÄúValue‚Äù column to sort them alphabetically (if not already). Scroll down to the entries starting with ‚ÄòT‚Äô ‚Äî you‚Äôll find the string that contains the flag in the format {THM/-----}.

<details>
  <summary>Click to reveal the answer</summary>

**The answer:** THM{STRINGS_FOUND}

</details>

---

### **Dynamic Analysis: What registry value was modified for persistence?**

When analyzing persistence, changes usually appear under the Run registry keys.
Using Regshot, first take Shot 1 (before running the malware) and wait until the Shot 2 option becomes available.
Then run HopHelper.exe, return to Regshot, and take Shot 2 (after execution).
Once the Compare button becomes available, click it.
In the Notepad results, look for any new or modified entries under a Run path ‚Äî this is the full registry path that was changed for persistence.

<details>
  <summary>Click to reveal the answer</summary>

**The answer:**
HKU\S-1-5-21-1966530601-3185510712-10604624-1008\Software\Microsoft\Windows\CurrentVersion\Run\HopHelper

</details>

---

### **Dynamic Analysis: What network protocol is HopHelper.exe using?**

Using ProcMon, open the tool and apply filters to remove unnecessary events.
Add a Process Name filter:
Process Name ‚Üí is ‚Üí HopHelper.exe
If it doesn't appear in the dropdown, run HopHelper.exe again so ProcMon detects it.
Click Add.
Add an Operation filter:
Operation ‚Üí contains ‚Üí TCP
Click Add.
Click OK to apply filters.

After filtering, expand the Path column in the results.
You will see connections using http, which indicates the network protocol used.

<details>
  <summary>Click to reveal the answer</summary>

**The answer:** http

</details>

---

### **Bonus: Can you find the web panel HopHelper.exe communicates with?**

Using the same filtered view in ProcMon where you found the http traffic, look to the left of the entry.
You will see the domain something-somethingbox ‚Äî this is the panel the malware communicates with.
You can verify this by opening the URL in the VM‚Äôs browser:
http://something-somethingbox

It will load a System Information Collector page.

<details>
  <summary>Click to reveal the answer</summary>

**The answer:** http://breachblocker-sandbox

</details>

---

## Thank you, ggs
